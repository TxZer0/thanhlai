# [xss-game] Level 1 - 6
## Level 1
<p>DÃ²ng 45, biáº¿n query Ä‘Æ°á»£c láº¥y tá»« tham sá»‘ query trÃªn URL Ä‘Æ°á»£c ná»‘i chuá»—i trá»±c tiáº¿p vÃ o HTML. Sau Ä‘Ã³, Ä‘Æ°á»£c render ra cÃ¹ng vá»›i header vÃ  footer.</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image.png)

<p>Sá»­ dá»¥ng tag script Ä‘á»ƒ trigger XSS: &lt;script&gt;alert(origin)&lt;/script&gt;</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-1.png)

## Level 2
<p>DÃ²ng 42 - 46, láº¥y ná»™i dung Ä‘Æ°á»£c post lÃªn lÆ°u vÃ o DB vÃ  hiá»ƒn thá»‹ láº¡i danh sÃ¡ch post sau khi cáº­p nháº­t</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-2.png)

<p>HÃ m displayPosts cÃ³ chá»©c nÄƒng chÃ­nh lÃ  duyá»‡t qua táº¥t cáº£ posts, ná»‘i cÃ¡c chuá»—i HTML (chá»©a message chÃ­nh lÃ  ná»™i dung post cá»§a user) vÃ  cáº­p nháº­t báº±ng hÃ m innerHTML. CÃ¡c message hoÃ n toÃ n khÃ´ng Ä‘Æ°á»£c escape HTML + innerHTML -> XSS</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-3.png)

<p>Hiá»‡n táº¡i, náº¿u chÃ¨n tag script báº±ng innerHTML thÃ¬ trÃ¬nh duyá»‡t sáº½ khÃ´ng thá»±c thi. Thay vÃ o Ä‘Ã³, sá»­ dá»¥ng cÃ¡c tag khÃ¡c nhÆ°: img, svg,... Ä‘á»ƒ trigger XSS -> Payload: &lt;img src=x onerror=alert(origin)&gt;</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-4.png)

## Level 3
<p>Äáº§u tiÃªn, biáº¿n num trong hÃ m chooseTab Ä‘Æ°á»£c láº¥y tá»« URL fragment (sau kÃ­ tá»± # trÃªn URL). DÃ²ng 16 - 17 thá»±c hiá»‡n ghÃ©p chuá»—i HTML Ä‘á»ƒ hiá»ƒn thá»‹ hÃ¬nh áº£nh vá»›i Ä‘Æ°á»ng dáº«n Ä‘á»™ng. DÃ²ng 18 sá»­ dá»¥ng jQuery Ä‘á»ƒ cáº­p nháº­t ná»™i dung HTML cá»§a pháº§n tá»­ cÃ³ id lÃ  tabContent -> CÃ³ kháº£ nÄƒng bá»‹ XSS. Tuy nhiÃªn, cáº§n kiá»ƒm tra xem parseInt() xá»­ lÃ½ nhÆ° tháº¿ nÃ o khi chá»©a payload XSS.</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-5.png)

<p>Thá»­ &lt;h1&gt; thÃ¬ parseInt(num) tráº£ vá» NaN vÃ  váº«n ná»‘i chuá»—i nhÆ° thÆ°á»ng</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-6.png)

<p>Sá»­ dá»¥ng '>< Ä‘á»ƒ kÃ©o dÃ i ná»™i dung html vÃ  white_space' Ä‘á»ƒ Ä‘Ã³ng chuá»—i .jpg -> Payload: &#39;&gt;&lt;img src=x onerror=alert(origin)&gt; '</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-7.png)

## Level 4
<p>Äáº§u tiÃªn, náº¿u chá»©a tham sá»‘ timer trÃªn URL thÃ¬ tráº£ vá» template timer.html vá»›i giÃ¡ trá»‹ timer. NgÆ°á»£c láº¡i thÃ¬ tráº£ vá» index.html. Tiáº¿p theo, cáº§n tÃ¬m hiá»ƒu timer.html Ä‘Æ°á»£c render cÃ¹ng vá»›i input nhÆ° tháº¿ nÃ o.</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-9.png)

<p>Trong timer.html, biáº¿n timer Ä‘Æ°á»£c nhÃºng vÃ o 2 nÆ¡i lÃ  dÃ²ng 21 vÃ  23 -> CÃ³ kháº£ nÄƒng bá»‹ XSS</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-8.png)

<p>Thá»­ &lt;script&gt;alert(origin)&lt;/script&gt; vÃ  káº¿t quáº£ Ä‘Ã£ bá»‹ escape. CÃ³ váº» nhÆ° template Ä‘Ã£ tá»± Ä‘á»™ng html entity encode biáº¿n timer -> DÃ²ng 23 khÃ´ng bá»‹ XSS.</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-10.png)

<p>DÃ²ng 21, biáº¿n timer Ä‘Æ°á»£c nhÃºng vÃ o lÃ m Ä‘á»‘i sá»‘ cá»§a hÃ m startTimer. TÆ°Æ¡ng tá»± lv3, váº«n sá»­ dá»¥ng cÃ¡ch ná»‘i dÃ i payload káº¿t há»£p vá»›i // Ä‘á»ƒ comment ') -> Payload: '); alert(origin)//</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-11.png)

## Level 5
<p>Äáº§u tiÃªn, tham sá»‘ next Ä‘Æ°á»£c nhÃºng vÃ o template confirm.html vÃ  lÃ  giÃ¡ trá»‹ URL dÃ¹ng Ä‘á»ƒ chuyá»ƒn hÆ°á»›ng.</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-13.png)

<p>Sá»­ dá»¥ng giao thá»©c javascript Ä‘á»ƒ trigger XSS -> Tham sá»‘ next=javascript:alert(origin)</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-12.png)

## Level 6
<p>Äáº§u tiÃªn, dÃ²ng 46 gá»i hÃ m includeGadget vÃ  Ä‘á»‘i sá»‘ lÃ  káº¿t quáº£ tráº£ vá» cá»§a hÃ m getGadgetName. Quan sÃ¡t, hÃ m getGadgetName tráº£ vá» pháº§n sau # hoáº·c máº·c Ä‘á»‹nh lÃ  /static/gadget.js </p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-15.png)

<p>Äi vÃ o hÃ m includeGadget: Ä‘áº§u tiÃªn, táº¡o má»™t pháº§n tá»­ script vÃ  kiá»ƒm tra xem url náº¿u khá»›p vá»›i http/https thÃ¬ hiá»ƒn thá»‹ pháº§n tá»­ log vá»›i ná»™i dung lÃ  khÃ´ng thá»ƒ load URL chá»©a http vÃ  káº¿t thÃºc hÃ m.</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-16.png)

<p>Tiáº¿p theo, gÃ¡n url vÃ o thuá»™c tÃ­nh src cá»§a pháº§n tá»­ script vá»«a táº¡o. Äoáº¡n code cÃ²n láº¡i dÃ¹ng Ä‘á»ƒ in ra thÃ´ng bÃ¡o log. VÃ¬ hÃ m setInnerText sá»­ dá»¥ng innerText vÃ  textContent nÃªn chá»‰ hiá»ƒn thá»‹ dÆ°á»›i dáº¡ng text mÃ  khÃ´ng thá»±c thi HTML -> Váº­y nÆ¡i cÃ³ thá»ƒ bá»‹ XSS cÃ²n láº¡i lÃ  thuá»™c tÃ­nh src cá»§a pháº§n tá»­ script. VÃ¬ http/https Ä‘Ã£ bá»‹ filter bá»Ÿi regex á»Ÿ trÃªn nÃªn khÃ´ng thá»ƒ load má»™t tá»‡p js báº±ng thÃ´ng qua URL. Tuy nhiÃªn, ngoÃ i cÃ¡ch nhÃºng URL thÃ¬ cÃ²n cÃ³ thá»ƒ nhÃºng js code dÆ°á»›i dáº¡ng data: vÃ o thuá»™c tÃ­nh src.</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-17.png)

<p>Payload: data:text/javascript,alert(origin) -> Trigger XSS thÃ nh cÃ´ng.</p>

![alt text](/thanhlai/post/web_exploitation/image/post6/image-14.png)

<p>TÃ³m láº¡i, Ä‘Ã¢y lÃ  toÃ n bá»™ ná»™i dung vá» challenge. Hy vá»ng writeup nÃ y giÃºp Ã­ch cho báº¡n ğŸ”¥.</p>
