# [Dreamhack] curling 
<p>Route /api/v1/test/internal: kiá»ƒm tra náº¿u ip gá»i Ä‘áº¿n lÃ  127.0.0.1 thÃ¬ tráº£ vá» ná»™i dung flag.</p>

![alt text](/thanhlai/post/web_exploitation/image/post11/image-1.png)

<p>Route /api/v1/test/curl: nháº­n tham sá»‘ url Ä‘á»ƒ xá»­ lÃ½ trÆ°á»›c khi gá»i curl. Äáº§u tiÃªn, kiá»ƒm tra náº¿u url khÃ´ng báº¯t Ä‘áº§u báº±ng http://dreamhack.io thÃ¬ return. Tiáº¿p theo, kiá»ƒm tra chuá»—i url cÃ³ káº¿t thÃºc báº±ng /test/internal hay khÃ´ng. Cuá»‘i cÃ¹ng, thá»±c hiá»‡n lá»‡nh curl.</p>

![alt text](/thanhlai/post/web_exploitation/image/post11/image-2.png)

<p>TÃ³m láº¡i, cÃ³ thá»ƒ láº¥y flag thÃ´ng qua SSRF táº¡i endpoint /api/v1/test/curl, nÆ¡i server dÃ¹ng lá»‡nh curl Ä‘á»ƒ truy cáº­p URL do user cung cáº¥p. VÃ¬ hÃ m startswith chá»‰ kiá»ƒm tra pháº§n Ä‘áº§u chuá»—i nÃªn cÃ³ thá»ƒ bypass báº±ng cÃ¡ch sá»­ dá»¥ng Ä‘á»‹nh dáº¡ng http://user@host/ -> Payload hiá»‡n táº¡i: http://dreamhack.io@127.0.0.1:8000/api/v1/test/internal. VÃ¬ hÃ m endswith khÃ´ng cho phÃ©p chuá»—i káº¿t thÃºc báº±ng /test/internal nÃªn sáº½ thÃªm má»™t kÃ­ tá»± ? Ä‘á»ƒ bypass -> Payload cuá»‘i cÃ¹ng: http://dreamhack.io@127.0.0.1:8000/api/v1/test/internal?</p>

![alt text](/thanhlai/post/web_exploitation/image/post11/image.png)

<p>TÃ³m láº¡i, Ä‘Ã¢y lÃ  toÃ n bá»™ ná»™i dung vá» challenge. Hy vá»ng writeup nÃ y giÃºp Ã­ch cho báº¡n ğŸ”¥.</p>