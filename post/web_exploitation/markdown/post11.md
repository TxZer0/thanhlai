# [Dreamhack] curling 
<p>Route /api/v1/test/internal: kiểm tra nếu ip gọi đến là 127.0.0.1 thì trả về nội dung flag.</p>

![alt text](/thanhlai/post/web_exploitation/image/post11/image-1.png)

<p>Route /api/v1/test/curl: nhận tham số url để xử lý trước khi gọi curl. Đầu tiên, kiểm tra nếu url không bắt đầu bằng http://dreamhack.io thì return. Tiếp theo, kiểm tra chuỗi url có kết thúc bằng /test/internal hay không. Cuối cùng, thực hiện lệnh curl.</p>

![alt text](/thanhlai/post/web_exploitation/image/post11/image-2.png)

<p>Tóm lại, có thể lấy flag thông qua SSRF tại endpoint /api/v1/test/curl, nơi server dùng lệnh curl để truy cập URL do user cung cấp. Vì hàm startswith chỉ kiểm tra phần đầu chuỗi nên có thể bypass bằng cách sử dụng định dạng http://user@host/ -> Payload hiện tại: http://dreamhack.io@127.0.0.1:8000/api/v1/test/internal. Vì hàm endswith không cho phép chuỗi kết thúc bằng /test/internal nên sẽ thêm một kí tự ? để bypass -> Payload cuối cùng: http://dreamhack.io@127.0.0.1:8000/api/v1/test/internal?</p>

![alt text](/thanhlai/post/web_exploitation/image/post11/image.png)

<p>Tóm lại, đây là toàn bộ nội dung về challenge. Hy vọng writeup này giúp ích cho bạn 🔥.</p>