# [DiceCTF-2025] cookie_recipes_v3
<p>Route /deliver: trả về nội dung flag nếu số lượng cookies của user hiện tại >= 1 tỷ. Số lượng cookies được lấy từ Map cookies thông qua giá trị của req.user.</p>

![alt text](/thanhlai/post/web_exploitation/image/post10/image.png)

<p>Middleware: set một giá trị được random cho cookie user và req.user -> Giá trị này dùng làm key để theo dõi số lượng cookie của từng user.</p>

![alt text](/thanhlai/post/web_exploitation/image/post10/image-1.png)

<p>Route /bake: lấy ra số lượng cookie từ tham số number trên URL. Nếu number.length <= 2 thì tăng số lượng cookie -> Đầu tiên, phải gán number bằng 1000000000. Tuy nhiên, độ dài lúc này đã lớn hơn 2 nên sẽ không không tăng thêm số lượng cookie.</p>

![alt text](/thanhlai/post/web_exploitation/image/post10/image-2.png)

<p>Có thể bypass việc kiểm tra length bằng cách sử dụng kiểu dữ liệu là mảng.</p>

![alt text](/thanhlai/post/web_exploitation/image/post10/image-5.png)

<p>Gửi đến endpoint /bake với tham số number[]=1000000000. Kết quả trả về đã hiển thị số lượng lớn hơn 1 tỷ.</p>

![alt text](/thanhlai/post/web_exploitation/image/post10/image-3.png)

<p>Truy cập đến /deliver, nội dung flag đã được hiển thị.</p>

![alt text](/thanhlai/post/web_exploitation/image/post10/image-4.png)

<p>Tóm lại, đây là toàn bộ nội dung về challenge. Hy vọng writeup này giúp ích cho bạn 🔥.</p>





