# [DiceCTF-2025] cookie_recipes_v3
<p>Route /deliver: tráº£ vá» ná»™i dung flag náº¿u sá»‘ lÆ°á»£ng cookies cá»§a user hiá»‡n táº¡i >= 1 tá»·. Sá»‘ lÆ°á»£ng cookies Ä‘Æ°á»£c láº¥y tá»« Map cookies thÃ´ng qua giÃ¡ trá»‹ cá»§a req.user.</p>

![alt text](/thanhlai/post/web_exploitation/image/post10/image.png)

<p>Middleware: set má»™t giÃ¡ trá»‹ Ä‘Æ°á»£c random cho cookie user vÃ  req.user -> GiÃ¡ trá»‹ nÃ y dÃ¹ng lÃ m key Ä‘á»ƒ theo dÃµi sá»‘ lÆ°á»£ng cookie cá»§a tá»«ng user.</p>

![alt text](/thanhlai/post/web_exploitation/image/post10/image-1.png)

<p>Route /bake: láº¥y ra sá»‘ lÆ°á»£ng cookie tá»« tham sá»‘ number trÃªn URL. Náº¿u number.length <= 2 thÃ¬ tÄƒng sá»‘ lÆ°á»£ng cookie -> Äáº§u tiÃªn, pháº£i gÃ¡n number báº±ng 1000000000. Tuy nhiÃªn, Ä‘á»™ dÃ i lÃºc nÃ y Ä‘Ã£ lá»›n hÆ¡n 2 nÃªn sáº½ khÃ´ng khÃ´ng tÄƒng thÃªm sá»‘ lÆ°á»£ng cookie.</p>

![alt text](/thanhlai/post/web_exploitation/image/post10/image-2.png)

<p>CÃ³ thá»ƒ bypass viá»‡c kiá»ƒm tra length báº±ng cÃ¡ch sá»­ dá»¥ng kiá»ƒu dá»¯ liá»‡u lÃ  máº£ng.</p>

![alt text](/thanhlai/post/web_exploitation/image/post10/image-5.png)

<p>Gá»­i Ä‘áº¿n endpoint /bake vá»›i tham sá»‘ number[]=1000000000. Káº¿t quáº£ tráº£ vá» Ä‘Ã£ hiá»ƒn thá»‹ sá»‘ lÆ°á»£ng lá»›n hÆ¡n 1 tá»·.</p>

![alt text](/thanhlai/post/web_exploitation/image/post10/image-3.png)

<p>Truy cáº­p Ä‘áº¿n /deliver, ná»™i dung flag Ä‘Ã£ Ä‘Æ°á»£c hiá»ƒn thá»‹.</p>

![alt text](/thanhlai/post/web_exploitation/image/post10/image-4.png)

<p>TÃ³m láº¡i, Ä‘Ã¢y lÃ  toÃ n bá»™ ná»™i dung vá» challenge. Hy vá»ng writeup nÃ y giÃºp Ã­ch cho báº¡n ğŸ”¥.</p>





