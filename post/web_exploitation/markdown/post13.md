# [PwnMe-2025] Profile Editor
<p>Endpoint /register: thực hiện thêm user mới bằng cách sử dụng key:value để lưu trữ username/password. Để ý rằng username và password có thể là chuỗi tùy ý nếu như username mới không trùng với username đã đăng ký.</p>

![alt text](/thanhlai/post/web_exploitation/image/post13/image.png)

<p>Endpoint /login: kiểm tra nếu username/password khớp thì chuyển hướng đến endpoint /profile.</p>

![alt text](/thanhlai/post/web_exploitation/image/post13/image-1.png)

<p>Endpoint /show_profile: kiểm tra nếu chưa đăng nhập thì chuyển hướng về trang login. Dòng 67, tạo đường dẫn từ chuỗi "profile/" nối với username. Dòng 69, kiểm tra nếu file không nằm trong thư mục gốc của ứng dụng (/app) thì trả về thông báo lỗi. Dòng 73-75, nếu file tồn tại thì đọc nội dung vào biến profile -> Có thể thao túng username thành đường dẫn tới file tùy ý miễn là nằm trong thư mục gốc của ứng dụng (/app).</p>

![alt text](/thanhlai/post/web_exploitation/image/post13/image-2.png)

<p>Kiểm tra trong container thì thấy rằng flag.txt có trong /app -> Sử dụng path traversal để từ /app/profile lùi lên thư mục /app để đọc flag -> Username phải có giá trị ../flag.txt.</p>

![alt text](/thanhlai/post/web_exploitation/image/post13/image-3.png)

<p>Các bước thực hiện: đăng ký username=../flag.txt -> login -> truy cập /show_profile.</p>

![alt text](/thanhlai/post/web_exploitation/image/post13/image-6.png)